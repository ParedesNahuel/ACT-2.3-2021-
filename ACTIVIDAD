--1)
SELECT COUNT(*) AS 'CANTIDAD DE COLABORADORES' FROM COLABORADORES
GO

--2)
SELECT COUNT(*) AS 'COLABORADORES 90�' FROM Colaboradores
WHERE YEAR(FechaNacimiento) BETWEEN 1990 AND 2000
GO

--3)
SELECT AVG (TT.PrecioHoraBase*1.0) AS 'PROMEDIO PRECIOBASE' FROM TIPOSTAREA AS TT
GO

--4)
SELECT AVG(PRO.CostoEstimado * 1.0) AS 'PROMEDIO COSTO PR' FROM Proyectos AS PRO
WHERE YEAR(FechaInicio)=2019
GO

--5)
SELECT MAX(PR.CostoEstimado) FROM Proyectos AS PR
INNER JOIN Clientes AS CL
ON CL.ID= PR.IDCliente
INNER JOIN TiposCliente AS TCL
ON CL.IDTipo= TCL.ID
WHERE TCL.Nombre LIKE 'UNICORNIO'

--6)
SELECT MIN(PR.CostoEstimado) AS 'COSTO MINIMO ARG' FROM Proyectos AS PR
INNER JOIN Clientes AS CL
ON CL.ID= PR.IDCliente
INNER JOIN Ciudades AS CI
ON CI.ID= CL.IDCiudad
INNER JOIN Paises AS P
ON CI.IDPais = P.ID
WHERE P.Nombre LIKE 'ARGENTINA'
GO

--7)
SELECT SUM(PR.CostoEstimado) FROM Proyectos AS PR
GO

--8)
SELECT CI.Nombre, COUNT (*) AS CLIENTES FROM CLIENTES AS CL
INNER JOIN Ciudades AS CI
ON CL.IDCiudad= CI.ID
GROUP BY CI.Nombre
GO

--9)
SELECT P.Nombre, COUNT (*) FROM Clientes AS CL
INNER JOIN Ciudades AS CI
ON CL.IDCiudad= CI.ID
RIGHT JOIN PAISES AS P
ON CI.IDPais= P.ID
GROUP BY P.Nombre
GO

SELECT P.Nombre, COUNT (CL.IDciudad) FROM Clientes AS CL
INNER JOIN Ciudades AS CI
ON CL.IDCiudad= CI.ID
INNER JOIN PAISES AS P
ON CI.IDPais= P.ID
GROUP BY P.Nombre
GO

--10)
SELECT TT.Nombre, COUNT(COL.IDColaborador) FROM Colaboraciones AS COL
INNER JOIN Tareas AS T
ON COL.IDTarea = T.ID
INNER JOIN TiposTarea AS TT
ON TT.ID= T.IDTipo
GROUP BY TT.Nombre

--11)
SELECT DISTINCT COUNT(*),TT.Nombre FROM COLABORADORES AS COL
INNER JOIN Colaboraciones AS C
ON COL.ID= C.IDColaborador
INNER JOIN Tareas AS T
ON T.ID= C.IDTarea
INNER JOIN TiposTarea AS TT
ON TT.ID= T.IDTipo
GROUP BY TT.Nombre
GO

SELECT DISTINCT COUNT (COLAB.ID) FROM Colaboradores AS COLAB
INNER JOIN Colaboraciones AS C
ON C.IDColaborador= COLAB.ID
INNER JOIN Tareas AS T
ON T.ID= C.IDTarea
INNER JOIN TiposTarea AS TT
ON T.IDTipo= TT.ID
GROUP BY TT.Nombre

--11)
SELECT DISTINCT COUNT(*),TT.Nombre FROM COLABORADORES AS COL
INNER JOIN Colaboraciones AS C
ON COL.ID= C.IDColaborador
INNER JOIN Tareas AS T
ON T.ID= C.IDTarea
INNER JOIN TiposTarea AS TT
ON TT.ID= T.IDTipo
GROUP BY TT.Nombre
GO

--12)
SELECT MO.ID,MO.Nombre,MO.TiempoEstimado FROM Modulos AS MO

--13)
SELECT MO.ID, MO.Nombre AS MODULOS, TT.Nombre AS TIPOTAREA, AVG(CO.Tiempo*1.0) FROM MODULOS AS MO
LEFT JOIN Tareas AS T
ON T.IDModulo= MO.ID
LEFT JOIN TiposTarea AS TT
ON TT.ID= T.IDTipo
LEFT JOIN COLABORACIONES AS CO
ON CO.IDTarea=T.ID
GROUP BY MO.ID,MO.Nombre,TT.Nombre
GO

--14)
SELECT MO.ID, COLAB.APELLIDO + ', ' +COLAB.NOMBRE AS 'APELLIDO Y NOMBRE' , SUM(CO.PrecioHora) AS ABONAR FROM MODULOS AS MO
INNER JOIN Tareas AS T
ON T.IDModulo= MO.ID
LEFT JOIN TiposTarea AS TT
ON TT.ID= T.IDTipo
INNER JOIN COLABORACIONES AS CO
ON CO.IDTarea=T.ID
LEFT JOIN Colaboradores AS COLAB
ON CO.IDColaborador= COLAB.ID
GROUP BY MO.ID,COLAB.Apellido + ', ' + COLAB.Nombre
GO

--15)
SELECT PR.Nombre, SUM(CO.Tiempo) AS TIEMPO,SUM(CO.PrecioHora*CO.Tiempo) AS PRECIO FROM Proyectos AS PR
INNER JOIN Modulos AS MO
ON MO.IDProyecto = PR.ID
INNER JOIN Tareas AS T
ON T.IDModulo= MO.ID
INNER JOIN COLABORACIONES AS CO
ON CO.IDTarea=T.ID
GROUP BY PR.Nombre
GO

--16)
SELECT PR.Nombre AS PROYECTO,COUNT (COLAB.ID),SUM(CO.Tiempo) FROM Proyectos AS PR
INNER JOIN Modulos AS MO
ON MO.IDProyecto = PR.ID
INNER JOIN Tareas AS T
ON T.IDModulo= MO.ID
INNER JOIN COLABORACIONES AS CO
ON CO.IDTarea=T.ID
INNER JOIN Colaboradores AS COLAB
ON CO.IDColaborador= COLAB.ID
GROUP BY PR.Nombre
HAVING COUNT (COLAB.ID)<5 AND SUM(CO.Tiempo)>100
GO

--17)
SELECT PR.Nombre, COUNT (MO.ID) AS MODULOS, YEAR(PR.FechaInicio) AS AÑO FROM Proyectos AS PR
INNER JOIN Modulos AS MO
ON PR.ID= MO.IDProyecto
WHERE YEAR(PR.FechaInicio)=2020
GROUP BY PR.Nombre,YEAR(PR.FechaInicio)
HAVING COUNT(MO.ID)>3
GO

--18)
SELECT COLAB.Apellido,COLAB.Nombre, MAX(COL.Tiempo) FROM Colaboradores AS COLAB
INNER JOIN Colaboraciones AS COL
ON COLAB.ID= COL.IDColaborador
WHERE COLAB.Tipo ='E'
GROUP BY COLAB.Apellido, COLAB.Nombre
GO

--19)
SELECT COLAB.Apellido,COLAB.Nombre,AVG(COL.IDColaborador*1.0) FROM Colaboradores AS COLAB
INNER JOIN Colaboraciones AS COL
ON COL.IDColaborador= COLAB.ID
WHERE COLAB.Tipo= 'I'
GROUP BY COLAB.Apellido,COLAB.Nombre
ORDER BY COLAB.Apellido,COLAB.Nombre ASC
GO

select 
	CONCAT(CO.Nombre,' ',CO.Apellido) as Colaborador,
	AVG(CB.Tiempo * CB.PrecioHora) as 'Promedio de colaboraciones'
from Colaboradores as CO
	left join Colaboraciones as CB on CB.IDColaborador = CO.ID
where CO.Tipo like 'I'
group by CONCAT(CO.Nombre,' ',CO.Apellido)
order by 'Colaborador' asc

SELECT COLAB.Apellido,COLAB.Nombre,COUNT(COL.IDColaborador)/COUNT(COLAB) FROM Colaboradores AS COLAB
INNER JOIN Colaboraciones AS COL
ON COL.IDColaborador= COLAB.ID
WHERE COLAB.Tipo= 'I'
GROUP BY COLAB.Apellido,COLAB.Nombre
ORDER BY COLAB.Apellido,COLAB.Nombre ASC
GO

SELECT COLAB.Apellido,COLAB.Nombre, (count(*)/count ALL COL) AS 'PROMEDIO'FROM Colaboraciones AS COL
INNER JOIN Colaboradores AS COLAB
ON COLAB.ID= COL.IDColaborador
WHERE COLAB.Tipo='I'
GROUP BY COLAB.Apellido,COLAB.Nombre
ORDER BY COLAB.Apellido,COLAB.Nombre ASC
GO
---que significa en concepto y como aplicarlo'¿
